# What is this

AWSで廉価にMinecraftのサーバーを運用するためのプログラム群です。

事前にAWS側で最低限の設定(VPC,IAM Role,デプロイ先lambda等)とリポジトリの設定(secrets,リポジトリ変数等)を行います。
その後GitHub Actionsからlambdaへプログラムをデプロイしておきます。

Minecraftサーバーを作成する際は、まずlambdaにブラウザからアクセスします。
Webページとして管理コンソールが開かれ、そのページからMinecraftサーバー用インスタンスが作成できます。
作成されたインスタンス上には、Minecraftサーバーと、インスタンスやMinecraftサーバーの状態を確認可能な簡素なWebサーバーが起動します。
インスタンスが作成されていると、管理コンソールページからサーバー状態確認ページへ自動で遷移します。

サーバー状態確認ページにはMinecraftサーバーへのアクセス情報も表示されます。
Java版であれば「マルチプレイ > ダイレクト接続」からアドレスを指定して接続します。

Minecraftサーバーにログインしているプレイヤーが不在の状態が一定時間続くと、必要に応じてワールドデータをS3にアーカイブするとともに、インスタンスを自動で終了します。
アーカイブされたワールドデータは次回インスタンス作成時に取得されます。


# How to setup

## 事前の設定 (AWS)

### VPC

### Security Group

### IAM Role

### lambda

### S3

## 事前の設定 (Optional: Discord)

### Webhook

## 事前の設定 (GitHub)

### secrets

### リポジトリ変数

### Lambdaへのデプロイ


# How to use

1. ブラウザから lambda の関数URLにアクセスする
2. パラメータを適当に選択し「起動する」ボタンを押す
3. インスタンスが起動するのを待つ (期待値は60～90秒程度)
4. インスタンスが起動するとサーバー状態確認ページへ自動で遷移する
5. Minecraftサーバーの初期化が完了するのを待つ (期待値は150～300秒程度)
6. 表示される「接続先情報」を設定してMinecraftサーバーへ接続する
7. 遊ぶ

サーバーにログインしているプレイヤーが不在の状態が一定時間続くと、
必要に応じてワールドデータをアーカイブしてからインスタンスが自動で終了するため、
遊び終わった後の対応は不要です。
